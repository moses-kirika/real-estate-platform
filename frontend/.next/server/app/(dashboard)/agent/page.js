(()=>{var e={};e.id=2519,e.ids=[2519],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},72248:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>o}),r(45920),r(10578),r(12874),r(41163);var a=r(27105),s=r(15265),n=r(90157),i=r.n(n),d=r(44665),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);r.d(t,l);let o=["",{children:["(dashboard)",{children:["agent",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,45920)),"C:\\Users\\kirika\\.gemini\\antigravity\\scratch\\real-estate-platform\\frontend\\app\\(dashboard)\\agent\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,10578)),"C:\\Users\\kirika\\.gemini\\antigravity\\scratch\\real-estate-platform\\frontend\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,12874,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,97418))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,41163)),"C:\\Users\\kirika\\.gemini\\antigravity\\scratch\\real-estate-platform\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,12874,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,97418))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\kirika\\.gemini\\antigravity\\scratch\\real-estate-platform\\frontend\\app\\(dashboard)\\agent\\page.tsx"],m="/(dashboard)/agent/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(dashboard)/agent/page",pathname:"/agent",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},39599:(e,t,r)=>{let a={"675446e0e49d0fd64ba83fd62071323d39a5833f":()=>Promise.resolve().then(r.bind(r,62626)).then(e=>e.completePropertyDeal),"8c299936c13335b79ecadd4eef4c4ae4748a42e4":()=>Promise.resolve().then(r.bind(r,62626)).then(e=>e.getAgentAnalytics)};async function s(e,...t){return(await a[e]()).apply(null,t)}e.exports={"675446e0e49d0fd64ba83fd62071323d39a5833f":s.bind(null,"675446e0e49d0fd64ba83fd62071323d39a5833f"),"8c299936c13335b79ecadd4eef4c4ae4748a42e4":s.bind(null,"8c299936c13335b79ecadd4eef4c4ae4748a42e4")}},53872:(e,t,r)=>{let a={"0eb3e6ea3cea093b3dee3a697fc793b554304b77":()=>Promise.resolve().then(r.bind(r,72223)).then(e=>e.register),bcdd3597cdaf7fd331e1f2c845bd1057a22095ed:()=>Promise.resolve().then(r.bind(r,72223)).then(e=>e.authenticate),db47c8c76a3a3c7d90fc08090ec69b98f34a3c1e:()=>Promise.resolve().then(r.bind(r,72223)).then(e=>e.signOutAction)};async function s(e,...t){return(await a[e]()).apply(null,t)}e.exports={"0eb3e6ea3cea093b3dee3a697fc793b554304b77":s.bind(null,"0eb3e6ea3cea093b3dee3a697fc793b554304b77"),bcdd3597cdaf7fd331e1f2c845bd1057a22095ed:s.bind(null,"bcdd3597cdaf7fd331e1f2c845bd1057a22095ed"),db47c8c76a3a3c7d90fc08090ec69b98f34a3c1e:s.bind(null,"db47c8c76a3a3c7d90fc08090ec69b98f34a3c1e")}},18502:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,50696,23))},62626:(e,t,r)=>{"use strict";r.r(t),r.d(t,{completePropertyDeal:()=>d,getAgentAnalytics:()=>l});var a=r(78453);r(46433);var s=r(72783),n=r(9620),i=r(80376);async function d(e){let t=await (0,s.I8)();if(!t||!t.user||"AGENT"!==t.user.role&&"ADMIN"!==t.user.role)throw Error("Unauthorized");let r=e.get("propertyId"),a=parseFloat(e.get("amount")),d=e.get("type");if(!r||isNaN(a))throw Error("Invalid deal information");let l=await n.db.property.findUnique({where:{id:r}});if(!l||l.ownerId!==t.user.id)throw Error("Property not found or access denied");await n.db.$transaction([n.db.transactionLog.create({data:{propertyId:r,agentId:t.user.id,amount:a,type:d}}),n.db.property.update({where:{id:r},data:{status:"SALE"===d?"SOLD":"RENTED"}})]),(0,i.revalidatePath)("/agent/properties"),(0,i.revalidatePath)("/agent"),(0,i.revalidatePath)("/agent/analytics")}async function l(){let e=await (0,s.I8)();if(!e||!e.user||"AGENT"!==e.user.role&&"ADMIN"!==e.user.role)throw Error("Unauthorized");let t=e.user.id,[r,a,i]=await Promise.all([n.db.transactionLog.findMany({where:{agentId:t},orderBy:{createdAt:"desc"}}),n.db.inquiry.count({where:{property:{ownerId:t}}}),n.db.property.count({where:{ownerId:t}})]),d=r.reduce((e,t)=>e+Number(t.amount),0),l=await n.db.inquiry.findMany({where:{property:{ownerId:t}},orderBy:{createdAt:"desc"},take:10,include:{property:{select:{title:!0}}}}),o=new Date;o.getFullYear(),o.getMonth();let c=[];for(let e=0;e<6;e++){let t=new Date(o.getFullYear(),o.getMonth()-5+e,1),a=new Date(o.getFullYear(),o.getMonth()-5+e+1,0),s=r.filter(e=>e.createdAt>=t&&e.createdAt<=a).reduce((e,t)=>e+Number(t.amount),0);c.push({month:t.toLocaleString("default",{month:"short"}),revenue:s})}return{totalRevenue:d,transactionCount:r.length,inquiryCount:a,propertyCount:i,recentInquiries:JSON.parse(JSON.stringify(l)),monthlyData:c,recentTransactions:r.slice(0,5).map(e=>({...e,amount:Number(e.amount),createdAt:e.createdAt.toISOString()}))}}(0,r(95660).h)([d,l]),(0,a.j)("675446e0e49d0fd64ba83fd62071323d39a5833f",d),(0,a.j)("8c299936c13335b79ecadd4eef4c4ae4748a42e4",l)},45920:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(35023),s=r(72783),n=r(62626),i=r(92588),d=r(83795),l=r(12457),o=r(74658),c=r(68222),m=r(66204),u=r(10682),x=r(24960);async function p(){let e=await (0,s.I8)();e&&(e.user?.role==="AGENT"||e.user?.role==="ADMIN")||(0,i.redirect)("/dashboard");let t=await (0,n.getAgentAnalytics)();return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-3xl font-serif font-bold tracking-tight text-primary",children:"Agent Dashboard"}),a.jsx("p",{className:"text-muted-foreground",children:"Manage your listings and inquiries."})]}),(0,a.jsxs)(u.default,{href:"/agent/analytics",className:"text-sm font-medium text-primary hover:text-primary/80 flex items-center gap-1 group",children:["View detailed analytics",a.jsx(l.Z,{className:"h-4 w-4 transition-transform group-hover:translate-x-0.5"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,a.jsxs)(d.Zb,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(d.ll,{className:"text-sm font-medium",children:"My Listings"}),a.jsx(o.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:t.propertyCount}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Total active properties"})]})]}),(0,a.jsxs)(d.Zb,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(d.ll,{className:"text-sm font-medium",children:"Received Inquiries"}),a.jsx(c.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:t.inquiryCount}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Messages from potential buyers"})]})]}),(0,a.jsxs)(d.Zb,{className:"hover:shadow-md transition-shadow bg-secondary/10 border-secondary/20",children:[(0,a.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(d.ll,{className:"text-sm font-medium",children:"Total Revenue"}),a.jsx(m.Z,{className:"h-4 w-4 text-secondary"})]}),(0,a.jsxs)(d.aY,{children:[a.jsx("div",{className:"text-2xl font-bold text-primary",children:(0,x.x)(t.totalRevenue)}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"From closed deals"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(d.Zb,{children:[a.jsx(d.Ol,{children:a.jsx(d.ll,{className:"text-lg",children:"Recent Inquiries"})}),a.jsx(d.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[t.recentInquiries.slice(0,3).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between border-b pb-2 last:border-0 last:pb-0",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:e.guestName||"User"}),a.jsx("p",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:e.property?.title||"Unknown Property"})]}),a.jsx("span",{className:"text-[10px] text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()})]},e.id)),0===t.recentInquiries.length&&a.jsx("div",{className:"text-center py-4 text-xs text-muted-foreground",children:"No recent inquiries"})]})})]}),(0,a.jsxs)(d.Zb,{children:[a.jsx(d.Ol,{children:a.jsx(d.ll,{className:"text-lg",children:"Latest Deals"})}),a.jsx(d.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[t.recentTransactions.slice(0,3).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between border-b pb-2 last:border-0 last:pb-0",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:e.type}),a.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()})]}),a.jsx("p",{className:"text-sm font-bold text-emerald-600",children:(0,x.x)(Number(e.amount))})]},e.id)),0===t.recentTransactions.length&&a.jsx("div",{className:"text-center py-4 text-xs text-muted-foreground",children:"No deals completed yet"})]})})]})]})]})}},83795:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>d,SZ:()=>o,Zb:()=>i,aY:()=>c,eW:()=>m,ll:()=>l});var a=r(35023),s=r(58003),n=r(24960);let i=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));i.displayName="Card";let d=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));d.displayName="CardHeader";let l=s.forwardRef(({className:e,...t},r)=>a.jsx("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let o=s.forwardRef(({className:e,...t},r)=>a.jsx("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));o.displayName="CardDescription";let c=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let m=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t}));m.displayName="CardFooter"},24960:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n,x:()=>i});var a=r(23779),s=r(45365);function n(...e){return(0,s.m6)((0,a.W)(e))}function i(e){return new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",maximumFractionDigits:0}).format(e)}},12457:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(64277).Z)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},66204:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(64277).Z)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},74658:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(64277).Z)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},68222:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(64277).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[916,2854,6401,9295,6914,1239,3557,1085,995],()=>r(72248));module.exports=a})();