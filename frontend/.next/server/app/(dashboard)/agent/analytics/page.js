(()=>{var e={};e.id=7181,e.ids=[7181],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},75010:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>o}),a(30821),a(10578),a(12874),a(41163);var r=a(27105),s=a(15265),n=a(90157),i=a.n(n),d=a(44665),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);a.d(t,l);let o=["",{children:["(dashboard)",{children:["agent",{children:["analytics",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,30821)),"C:\\Users\\kirika\\.gemini\\antigravity\\scratch\\real-estate-platform\\frontend\\app\\(dashboard)\\agent\\analytics\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,10578)),"C:\\Users\\kirika\\.gemini\\antigravity\\scratch\\real-estate-platform\\frontend\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,12874,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,97418))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,41163)),"C:\\Users\\kirika\\.gemini\\antigravity\\scratch\\real-estate-platform\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,12874,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,97418))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\kirika\\.gemini\\antigravity\\scratch\\real-estate-platform\\frontend\\app\\(dashboard)\\agent\\analytics\\page.tsx"],m="/(dashboard)/agent/analytics/page",h={require:a,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(dashboard)/agent/analytics/page",pathname:"/agent/analytics",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},39599:(e,t,a)=>{let r={"675446e0e49d0fd64ba83fd62071323d39a5833f":()=>Promise.resolve().then(a.bind(a,62626)).then(e=>e.completePropertyDeal),"8c299936c13335b79ecadd4eef4c4ae4748a42e4":()=>Promise.resolve().then(a.bind(a,62626)).then(e=>e.getAgentAnalytics)};async function s(e,...t){return(await r[e]()).apply(null,t)}e.exports={"675446e0e49d0fd64ba83fd62071323d39a5833f":s.bind(null,"675446e0e49d0fd64ba83fd62071323d39a5833f"),"8c299936c13335b79ecadd4eef4c4ae4748a42e4":s.bind(null,"8c299936c13335b79ecadd4eef4c4ae4748a42e4")}},53872:(e,t,a)=>{let r={"0eb3e6ea3cea093b3dee3a697fc793b554304b77":()=>Promise.resolve().then(a.bind(a,72223)).then(e=>e.register),bcdd3597cdaf7fd331e1f2c845bd1057a22095ed:()=>Promise.resolve().then(a.bind(a,72223)).then(e=>e.authenticate),db47c8c76a3a3c7d90fc08090ec69b98f34a3c1e:()=>Promise.resolve().then(a.bind(a,72223)).then(e=>e.signOutAction)};async function s(e,...t){return(await r[e]()).apply(null,t)}e.exports={"0eb3e6ea3cea093b3dee3a697fc793b554304b77":s.bind(null,"0eb3e6ea3cea093b3dee3a697fc793b554304b77"),bcdd3597cdaf7fd331e1f2c845bd1057a22095ed:s.bind(null,"bcdd3597cdaf7fd331e1f2c845bd1057a22095ed"),db47c8c76a3a3c7d90fc08090ec69b98f34a3c1e:s.bind(null,"db47c8c76a3a3c7d90fc08090ec69b98f34a3c1e")}},57588:(e,t,a)=>{Promise.resolve().then(a.bind(a,94957))},94957:(e,t,a)=>{"use strict";a.d(t,{AnalyticsCharts:()=>n});var r=a(19899),s=a(5507);function n({data:e}){let t=(0,s.useMemo)(()=>Math.max(...e.map(e=>e.revenue),1e3),[e]);return r.jsx("div",{className:"w-full h-64 flex items-end justify-between gap-2 pt-6",children:e.map((e,a)=>{let s=t>0?e.revenue/t*100:0,n=isNaN(s)?0:Math.max(s,2);return(0,r.jsxs)("div",{className:"flex-1 flex flex-col items-center gap-2 group",children:[(0,r.jsxs)("div",{className:"relative w-full flex flex-col items-center justify-end h-full group",children:[(0,r.jsxs)("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-zinc-900 text-white text-[10px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10",children:["$",e.revenue.toLocaleString()]}),r.jsx("div",{className:"w-full bg-gradient-to-t from-sky-500 to-sky-400 rounded-t-sm transition-all duration-500 group-hover:from-sky-400 group-hover:to-sky-300",style:{height:`${n}%`}})]}),r.jsx("span",{className:"text-[10px] text-muted-foreground uppercase font-medium",children:e.month})]},a)})})}},62626:(e,t,a)=>{"use strict";a.r(t),a.d(t,{completePropertyDeal:()=>d,getAgentAnalytics:()=>l});var r=a(78453);a(46433);var s=a(72783),n=a(9620),i=a(80376);async function d(e){let t=await (0,s.I8)();if(!t||!t.user||"AGENT"!==t.user.role&&"ADMIN"!==t.user.role)throw Error("Unauthorized");let a=e.get("propertyId"),r=parseFloat(e.get("amount")),d=e.get("type");if(!a||isNaN(r))throw Error("Invalid deal information");let l=await n.db.property.findUnique({where:{id:a}});if(!l||l.ownerId!==t.user.id)throw Error("Property not found or access denied");await n.db.$transaction([n.db.transactionLog.create({data:{propertyId:a,agentId:t.user.id,amount:r,type:d}}),n.db.property.update({where:{id:a},data:{status:"SALE"===d?"SOLD":"RENTED"}})]),(0,i.revalidatePath)("/agent/properties"),(0,i.revalidatePath)("/agent"),(0,i.revalidatePath)("/agent/analytics")}async function l(){let e=await (0,s.I8)();if(!e||!e.user||"AGENT"!==e.user.role&&"ADMIN"!==e.user.role)throw Error("Unauthorized");let t=e.user.id,[a,r,i]=await Promise.all([n.db.transactionLog.findMany({where:{agentId:t},orderBy:{createdAt:"desc"}}),n.db.inquiry.count({where:{property:{ownerId:t}}}),n.db.property.count({where:{ownerId:t}})]),d=a.reduce((e,t)=>e+Number(t.amount),0),l=await n.db.inquiry.findMany({where:{property:{ownerId:t}},orderBy:{createdAt:"desc"},take:10,include:{property:{select:{title:!0}}}}),o=new Date;o.getFullYear(),o.getMonth();let c=[];for(let e=0;e<6;e++){let t=new Date(o.getFullYear(),o.getMonth()-5+e,1),r=new Date(o.getFullYear(),o.getMonth()-5+e+1,0),s=a.filter(e=>e.createdAt>=t&&e.createdAt<=r).reduce((e,t)=>e+Number(t.amount),0);c.push({month:t.toLocaleString("default",{month:"short"}),revenue:s})}return{totalRevenue:d,transactionCount:a.length,inquiryCount:r,propertyCount:i,recentInquiries:JSON.parse(JSON.stringify(l)),monthlyData:c,recentTransactions:a.slice(0,5).map(e=>({...e,amount:Number(e.amount),createdAt:e.createdAt.toISOString()}))}}(0,a(95660).h)([d,l]),(0,r.j)("675446e0e49d0fd64ba83fd62071323d39a5833f",d),(0,r.j)("8c299936c13335b79ecadd4eef4c4ae4748a42e4",l)},30821:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var r=a(35023),s=a(72783),n=a(62626),i=a(92588),d=a(83795),l=a(66204);let o=(0,a(64277).Z)("handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);var c=a(68222),m=a(74658),h=a(38313),x=a(80358),u=a(24960);let p=(0,a(2772).createProxy)(String.raw`C:\Users\kirika\.gemini\antigravity\scratch\real-estate-platform\frontend\components\analytics-charts.tsx#AnalyticsCharts`);async function f(){let e=await (0,s.I8)();e&&(e.user?.role==="AGENT"||e.user?.role==="ADMIN")||(0,i.redirect)("/dashboard");let t=await (0,n.getAgentAnalytics)();return(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Analytics Dashboard"}),r.jsx("p",{className:"text-muted-foreground",children:"Track your progress and performance."})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)(d.Zb,{className:"bg-gradient-to-br from-white to-sky-50 border-sky-100 shadow-sm",children:[(0,r.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(d.ll,{className:"text-sm font-medium",children:"Total Revenue"}),r.jsx(l.Z,{className:"h-4 w-4 text-sky-600"})]}),(0,r.jsxs)(d.aY,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(0,u.x)(t.totalRevenue)}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Earnings from deals"})]})]}),(0,r.jsxs)(d.Zb,{className:"bg-gradient-to-br from-white to-emerald-50 border-emerald-100 shadow-sm",children:[(0,r.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(d.ll,{className:"text-sm font-medium",children:"Deals Completed"}),r.jsx(o,{className:"h-4 w-4 text-emerald-600"})]}),(0,r.jsxs)(d.aY,{children:[r.jsx("div",{className:"text-2xl font-bold",children:t.transactionCount}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Sales and rentals"})]})]}),(0,r.jsxs)(d.Zb,{className:"bg-gradient-to-br from-white to-orange-50 border-orange-100 shadow-sm",children:[(0,r.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(d.ll,{className:"text-sm font-medium",children:"Total Inquiries"}),r.jsx(c.Z,{className:"h-4 w-4 text-orange-600"})]}),(0,r.jsxs)(d.aY,{children:[r.jsx("div",{className:"text-2xl font-bold",children:t.inquiryCount}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Potential client reach"})]})]}),(0,r.jsxs)(d.Zb,{className:"bg-gradient-to-br from-white to-indigo-50 border-indigo-100 shadow-sm",children:[(0,r.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(d.ll,{className:"text-sm font-medium",children:"Active Listings"}),r.jsx(m.Z,{className:"h-4 w-4 text-indigo-600"})]}),(0,r.jsxs)(d.aY,{children:[r.jsx("div",{className:"text-2xl font-bold",children:t.propertyCount}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently on market"})]})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-7",children:[(0,r.jsxs)(d.Zb,{className:"md:col-span-4 shadow-sm border-zinc-100",children:[(0,r.jsxs)(d.Ol,{children:[(0,r.jsxs)(d.ll,{className:"flex items-center gap-2",children:[r.jsx(h.Z,{className:"h-5 w-5 text-sky-500"}),"Revenue Trend"]}),r.jsx(d.SZ,{children:"Visualizing your earnings over the last 6 months."})]}),r.jsx(d.aY,{children:r.jsx(p,{data:t.monthlyData})})]}),(0,r.jsxs)(d.Zb,{className:"md:col-span-3 shadow-sm border-zinc-100",children:[(0,r.jsxs)(d.Ol,{children:[(0,r.jsxs)(d.ll,{className:"flex items-center gap-2",children:[r.jsx(x.Z,{className:"h-5 w-5 text-emerald-500"}),"Recent Deals"]}),r.jsx(d.SZ,{children:"Your latest closed transactions."})]}),r.jsx(d.aY,{children:r.jsx("div",{className:"space-y-4",children:t.recentTransactions.length>0?t.recentTransactions.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-zinc-50 border border-zinc-100 transition-hover hover:bg-zinc-100",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-semibold",children:[e.type," Deal"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()})]}),r.jsx("div",{className:"text-right",children:(0,r.jsxs)("p",{className:"text-sm font-bold text-emerald-600",children:["+",(0,u.x)(Number(e.amount))]})})]},e.id)):r.jsx("div",{className:"text-center py-10 text-muted-foreground",children:"No transactions yet."})})})]})]}),(0,r.jsxs)(d.Zb,{className:"shadow-sm border-zinc-100",children:[(0,r.jsxs)(d.Ol,{children:[r.jsx(d.ll,{children:"Recent Inquiries"}),r.jsx(d.SZ,{children:"Keep track of potential leads from your listings."})]}),r.jsx(d.aY,{children:(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[t.recentInquiries.map(e=>(0,r.jsxs)("div",{className:"p-4 rounded-xl border border-zinc-100 bg-white shadow-sm ring-1 ring-zinc-50 transition-all hover:shadow-md hover:border-sky-100",children:[r.jsx("p",{className:"text-sm font-semibold text-zinc-900 line-clamp-1",children:e.property.title}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["From: ",e.guestName||"Authenticated User"]}),(0,r.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[r.jsx("span",{className:"text-[10px] bg-sky-50 text-sky-700 px-2 py-0.5 rounded-full font-medium",children:"New Lead"}),r.jsx("span",{className:"text-[10px] text-zinc-400",children:new Date(e.createdAt).toLocaleDateString()})]})]},e.id)),0===t.recentInquiries.length&&r.jsx("div",{className:"col-span-full py-10 text-center text-muted-foreground",children:"No inquiries received yet."})]})})]})]})}},83795:(e,t,a)=>{"use strict";a.d(t,{Ol:()=>d,SZ:()=>o,Zb:()=>i,aY:()=>c,eW:()=>m,ll:()=>l});var r=a(35023),s=a(58003),n=a(24960);let i=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));i.displayName="Card";let d=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));d.displayName="CardHeader";let l=s.forwardRef(({className:e,...t},a)=>r.jsx("h3",{ref:a,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let o=s.forwardRef(({className:e,...t},a)=>r.jsx("p",{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));o.displayName="CardDescription";let c=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,n.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let m=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t}));m.displayName="CardFooter"},24960:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n,x:()=>i});var r=a(23779),s=a(45365);function n(...e){return(0,s.m6)((0,r.W)(e))}function i(e){return new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",maximumFractionDigits:0}).format(e)}},80358:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(64277).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},66204:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(64277).Z)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},74658:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(64277).Z)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},68222:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(64277).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},38313:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(64277).Z)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[916,2854,6401,9295,6914,1239,3557,1085,995],()=>a(75010));module.exports=r})();